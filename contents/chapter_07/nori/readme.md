# 07 데이터 베이스 언어 SQL ( View 만 )

# 4. 뷰

## 1. 뷰의 개념

- 뷰는 다른 테이블을 기반으로 만들어진 `가상 테이블`이다.
- 뷰를 만드는데 기반이 되는 물리적인 테이블을 `기본 테이블`이라 한다.
    - 다른 뷰를 기반으로 새로운 뷰를 만들 수도 있다.
- 일반 테이블과 달리 **데이터를 실제로 저장하고 있지 않다.**
- 뷰는 일반 테이블과 동일하게 사용할 수 있어 일반 테이블과 차이를 느끼기 어렵다.
- 뷰를 통해 기본 테이블의 내용을 검색할 수 있지만 **수정은 제한적으로 가능하다.**

## 2. 뷰의 생성

```sql
CREATE VIEW 뷰_이름[(속성_리스트)] 
AS SELECT 문
[WITH CHECK OPTION];
```

- ORDER BY 사용 불가
- 뷰를 구성하는 속성_리스트 생략 가능 → SELECT 절의 속성 이름으로 대체 됨
- `WITH CHECK OPTION` 제약조건을 건다.

## 3. 뷰의 활용

- 가상 테이블임에도 SELECT 문을 활용해 검색이 가능하다.
- 뷰에 대한 SELECT 문이 내부적으로 기본테이블에 대한 로직으로 변환되어 수행되기 때문이다.
- INSERT, UPDATE, DELETE 문도 뷰를 대상으로 수행이 가능하다. (기본테이블에 반영됨)
    - 어떤 튜플을 변경할지 명확하게 알려주어야 함. (기본키 속성이 있어야 함)


### 변경이 불가능한 뷰의 특징

- 기본 테이블의 기본키를 구성하는 속성이 포함되어 있지 않은 뷰는 변경할 수 없다.
- 기본 테이블에 있던 내용이 아니라 집계 함수로 새로 계산된 내용을 포함하고 있는 뷰는 변경이 불가하다.
- DISTINCT 키워드를 포함하여 정의한 뷰는 변경할 수 없다.
- GROUP BY 절을 포함하여 정의한 뷰는 변경할 수 없다.
- 여러 개의 테이블을 조인하여 정의한 뷰는 변경할 수 없는 경우가 많다.

### 뷰의 장점

- 질의문을 좀 더 쉽게 작성할 수 있다.
    - 특정 조건을 만족하는 투플들로 뷰를 미리 만들어 놓으면 **쉽게 검색이 가능하다.** **복잡한 쿼리들을 작성할 필요가 없다.**
- 데이터의 보안 유지에 도움이 된다.
    - 요구에 맞는 뷰를 미리 정의해두고, 뷰를 통해서만 데이터에 접근 하도록 권한을 설정하면 데이터를 보호할 수 있다.
    - 예를 들어 여러개의 schema나 user로 구성된 database가 있는데, 특정 유저가 A라는 스키마의 테이블을 보는 권한이 없고, 더불어 보안상 봐서도 안된다라고 가정 한 상태에서, 그 유저가 A 스키마내 특정 테이블의 어떤 정보는 업무상 꼭 필요하다 할때, 이럴때 view를 생성하여 꼭 필요한것만 보여주고, 전체 정보는 공개하지 않게 할 수 있다.
- 데이터를 좀 더 편리하게 관리할 수 있다.
    - 제공된 뷰만 신경쓰면 된다.


## 4. 뷰의 삭제

```sql
DROP VIEW 뷰_이름;
```

- 뷰를 삭제하더라도 기본 테이블은 영향을 받지 않는다.
- 만약 삭제할 뷰를 참조하는 제약조건이 존재한다면 삭제가 수행되지 않는다.
